<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8" name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="resource/js/jquery.js"></script>
    <link rel="stylesheet" href="resource/css/bootstrap.min.css">
    <link rel="stylesheet" href="resource/css/bootstrap-theme.min.css">
    <script src="resource/js/bootstrap.min.js"></script>
    <script src="resource/js/echarts.min.js"></script>
    <script src="./resource/js/shine.js"></script>
    <title>生产线</title>

    <style type=text/css>
        div.light-status-1 {
            width: 50px;
            height: 50px;
            border-radius: 25%;
            background-color: gray;
            border-width: 1px;
            border-style: solid;
            margin: 0 auto
        }

        div.light-status-2 {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: gray;
            border-width: 1px;
            border-style: solid;
            margin: 0 auto
        }

        #light-stop,
        #light-running,
        #light-warning {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: white;
            border-width: 1px;
            border-style: solid;
            margin: 0 auto
        }

        /* 以下为PC端自适应CSS */
        @media screen and (min-width: 1200px) {
            div.row .col-md-12 {
                height: 64px;
                /* border: solid 2px black; */
            }

            div.row .col-md-6 {
                height: 364px;
                /* border: solid 2px black; */
                float: left;
            }
        }
    </style>

    <script>
        $(function () {
            Chart1.showLoading();
            Chart2.showLoading();
            Chart3.showLoading();
            Chart4.showLoading();
            Chart5.showLoading();
            Chart6.showLoading();
            timeChart.showLoading();
            PressPiechart.showLoading();
            TorquePiechart.showLoading();
            DisplacePiechart.showLoading();
            Colchart.showLoading();
            var cboxflag = [0, 0, 0, 0];
            var checkbox1 = $('#cboxA');
            var checkbox2 = $('#cboxB');
            var checkbox3 = $('#cboxC');
            var checkbox4 = $('#cboxD');

            checkbox1.click(function () {
                var c1 = $('#chart3');
                var c11 = [$('#chart4'), $('#chart5'), $('#chart6')];
                var cbox1 = [$('#cboxB'), $('#cboxC'), $('#cboxD')];
                if (!cboxflag[0]) {
                    for (var i = 0; i < c11.length; i++) {
                        c11[i].hide();
                    }
                    for (var i = 0; i < cbox1.length; i++) {
                        cbox1[i].attr("disabled", "disabled");
                    }
                    cboxflag[0] = 1;
                    checkbox1.addClass("active");
                    c1.css("height", function () { return $(document).height() * 0.8; });
                    c1.css("width", function () { return $(document).width(); });
                    Chart3.resize();
                } else {
                    cboxflag[0] = 0;
                    checkbox1.removeClass("active");
                    c1.css("height", '364px');
                    c1.css("width", '');
                    Chart3.resize();
                    for (var i = 0; i < c11.length; i++) {
                        c11[i].fadeIn();
                    }
                    for (var i = 0; i < cbox1.length; i++) {
                        cbox1[i].removeAttr("disabled");
                    }
                }
            })

            checkbox2.click(function () {
                var c2 = $('#chart4');
                var c12 = [$('#chart5'), $('#chart3'), $('#chart6')];
                var cbox2 = [$('#cboxA'), $('#cboxC'), $('#cboxD')];
                if (!cboxflag[1]) {
                    for (var i = 0; i < c12.length; i++) {
                        c12[i].hide();
                    }
                    for (var i = 0; i < cbox2.length; i++) {
                        cbox2[i].attr("disabled", "disabled");
                    }
                    cboxflag[1] = 1;
                    checkbox2.addClass("active");
                    c2.css("height", function () { return $(document).height() * 0.8; });
                    c2.css("width", function () { return $(document).width(); });
                    Chart4.resize();
                } else {
                    cboxflag[1] = 0;
                    checkbox2.removeClass("active");
                    c2.css("height", '364px');
                    c2.css("width", '');
                    Chart4.resize();
                    for (var i = 0; i < c12.length; i++) {
                        c12[i].fadeIn();
                    }
                    for (var i = 0; i < cbox2.length; i++) {
                        cbox2[i].removeAttr("disabled");
                    }
                }
            })
            checkbox3.click(function () {
                var c3 = $('#chart5');
                var c13 = [$('#chart4'), $('#chart3'), $('#chart6')];
                var cbox3 = [$('#cboxB'), $('#cboxA'), $('#cboxD')];
                if (!cboxflag[2]) {
                    for (var i = 0; i < c13.length; i++) {
                        c13[i].hide();
                    }
                    for (var i = 0; i < cbox3.length; i++) {
                        cbox3[i].attr("disabled", "disabled");
                    }
                    cboxflag[2] = 1;
                    checkbox3.addClass("active");
                    c3.css("height", function () { return $(document).height() * 0.8; });
                    c3.css("width", function () { return $(document).width(); });
                    Chart5.resize();
                } else {
                    cboxflag[2] = 0;
                    checkbox3.removeClass("active");
                    c3.css("height", '364px');
                    c3.css("width", '');
                    Chart5.resize();
                    for (var i = 0; i < c13.length; i++) {
                        c13[i].fadeIn();
                    }
                    for (var i = 0; i < cbox3.length; i++) {
                        cbox3[i].removeAttr("disabled");
                    }
                }
            })

            checkbox4.click(function () {
                var c4 = $('#chart6');
                var c14 = [$('#chart4'), $('#chart5'), $('#chart3')];
                var cbox4 = [$('#cboxB'), $('#cboxC'), $('#cboxA')];
                if (!cboxflag[3]) {
                    for (var i = 0; i < c14.length; i++) {
                        c14[i].hide();
                    }
                    for (var i = 0; i < cbox4.length; i++) {
                        cbox4[i].attr("disabled", "disabled");
                    }
                    cboxflag[3] = 1;
                    checkbox4.addClass("active");
                    c4.css("height", function () { return $(document).height() * 0.8; });
                    c4.css("width", function () { return $(document).width(); });
                    Chart6.resize();
                } else {
                    cboxflag[3] = 0;
                    checkbox4.removeClass("active");
                    c4.css("height", '364px');
                    c4.css("width", '');
                    Chart6.resize();
                    for (var i = 0; i < c14.length; i++) {
                        c14[i].fadeIn();
                    }
                    for (var i = 0; i < cbox4.length; i++) {
                        cbox4[i].removeAttr("disabled");
                    }
                }
            })
            getData();
            freshLine();
        });

        function ResizeLoading() {
            setTimeout("Resize()", "1");
        }

        function Resize() {
            Chart1.resize();
            Chart2.resize();
            Chart3.resize();
            Chart4.resize();
            Chart5.resize();
            Chart6.resize();
            Colchart.resize();
            timeChart.resize();
            PressPiechart.resize();
            TorquePiechart.resize();
            DisplacePiechart.resize();
        }

        $(window).resize(function () {
            Resize();
        });
    </script>
</head>

<body>
    <div id="wrapper">
        <div class="container-fluid">
            <h1 text-align="center" class="page-header">生产线工艺数据统计
                <button class="btn btn-default" type="button" id="warningWatch" style="float:right"
                    onclick="warningBtn()">
                    报警界面
                </button>
                <button class="btn btn-default" type="button" id="statusWatch" style="float:right;margin-right: 5px;"
                    onclick="statusBtn()">
                    状态监控
                </button>
            </h1>
            <div class="tabbable">
                <ul class="nav nav-tabs" style="margin-bottom: 10px;">
                    <li class="active" id="tab_btn_1"><a href="#tab1" data-toggle="tab"
                            onclick="ResizeLoading()">拧紧参数监控</a>
                    </li>
                    <li id="tab_btn_2"><a href="#tab2" data-toggle="tab" onclick="ResizeLoading()">压装参数监控</a>
                    </li>
                    <li id="tab_btn_3"><a href="#tab3" data-toggle="tab" onclick="ResizeLoading()">瓶颈工位监控</a>
                    </li>
                    <li id="tab_btn_4"><a href="#tab4" data-toggle="tab" onclick="warningBtn()">报警页面</a>
                    </li>
                    <li id="tab_btn_5"><a href="#tab5" data-toggle="tab" onclick="statusBtn()">状态监控</a>
                    </li>
                    <li id="tab_btn_6"><a href="#tab6" data-toggle="tab" onclick="ResizeLoading()">指标监控</a>
                    </li>
                    <li id="tab_btn_7"><a href="#tab7" data-toggle="tab">产品信息</a>
                    </li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="tab1">
                        <div class="row">
                            <div id="chart1" class="col-md-12 col-sm-12" style="height: 364px;"></div>
                            <div id="chart2" class="col-md-12 col-sm-12" style="height: 364px;"></div>
                            <form id="ChangeTight" class="col-md-12 col-sm-12" style="margin-left: 40%;width: 20%;">
                                <p>
                                <h3 align="center">拧紧参数阈值修改</h3>
                                <p>
                                <div class="input-group">
                                    <span class="input-group-addon" id="th">高位阈值(当前值: 5)</span>
                                    <input type="text" class="form-control" id="Thigh" aria-describedby="basic-addon3">
                                </div>
                                </p>
                                <p>
                                <div class="input-group">
                                    <span class="input-group-addon" id="tl">低位阈值(当前值: -5)</span>
                                    <input type="text" class="form-control" id="Tlow" aria-describedby="basic-addon3">
                                </div>
                                </p>
                                <p style="text-align:center;">
                                    <button type="button" class="btn btn-success" onclick="ChangeTight()">提交</button>
                                    <button type="button" onclick="Reset()" class="btn btn-warning">重置</button>
                                </p>
                            </form>
                        </div>
                    </div>


                    <div class="tab-pane" id="tab2">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-12 col-sm-12">
                                    <button type="button" class="btn btn-success" id="cboxA"
                                        style="margin-left: 14.5%;margin-top: 1%;">OP010SA压力</button>
                                    <button type="button" class="btn btn-success" id="cboxB"
                                        style="margin-left: 14.5%;margin-top: 1%;">OP010SA位移</button>
                                    <button type="button" class="btn btn-warning" id="cboxC"
                                        style="margin-left: 14.5%;margin-top: 1%;">OP020SA压力</button>
                                    <button type="button" class="btn btn-warning" id="cboxD"
                                        style="margin-left: 14.5%;margin-top: 1%;">OP020SA位移</button>
                                </div>
                                <div id="chart3" class="col-md-6"></div>
                                <div id="chart4" class="col-md-6"></div>
                                <div id="chart5" class="col-md-6"></div>
                                <div id="chart6" class="col-md-6"></div>

                                <form id="ChangePress" class="col-md-12 col-sm-12" style="margin-left: 40%;width: 20%;">
                                    <p>
                                    <h3 align="center">压装参数位移值阈值修改</h3>
                                    <p>
                                    <div class="input-group">
                                        <span class="input-group-addon" id="ph">高位阈值(当前值: 5)</span>
                                        <input type="text" class="form-control" id="Phigh"
                                            aria-describedby="basic-addon3">
                                    </div>
                                    </p>
                                    <p>
                                    <div class="input-group">
                                        <span class="input-group-addon" id="pl">低位阈值(当前值: -5)</span>
                                        <input type="text" class="form-control" id="Plow"
                                            aria-describedby="basic-addon3">
                                    </div>
                                    </p>
                                    <p style="text-align:center;">
                                        <button type="button" class="btn btn-success"
                                            onclick="ChangePress()">提交</button>
                                        <button type="button" onclick="Reset()" class="btn btn-warning">重置</button>
                                    </p>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane" id="tab3">
                        <div class="col-md-12 col-sm-12" id="neckbox">
                            <div id="ColChart" style="height: 300px;"></div>
                            <div class="alert alert-danger" role="alert" style="text-align: center;">
                                当前瓶颈工位为：<a class="alert-link" id="bottlenID"></a>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane" id="tab4">
                        <div id="box1" class="col-md-6 col-sm-6">
                            <div class="panel panel-danger" style="margin-top: 20px;">
                                <div class="panel-heading">
                                    <h3 class="panel-title">严重危险警报</h3>
                                </div>
                                <div class="panel-body" style="overflow-y:auto;height: 550px;" id="warningLog1"></div>
                            </div>
                        </div>
                        <div id="box2" class="col-md-6 col-sm-6">
                            <div class="panel panel-warning" style="margin-top: 20px;">
                                <div class="panel-heading">
                                    <h3 class="panel-title">潜在危险警报</h3>
                                </div>
                                <div class="panel-body" id="warningLog2" style="overflow-y:auto;height: 550px;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane" id="tab5">
                        <div class="row">
                            <div class="col-12">
                                <h3>PLC状态</h3>
                                <div class="row">
                                    <div class="col-md-4">
                                        <div id="light-stop"></div>
                                        <h4 style="text-align: center;">停机</h4>
                                    </div>
                                    <div class="col-md-4">
                                        <div id="light-running"></div>
                                        <h4 style="text-align: center;">运行</h4>
                                    </div>
                                    <div class="col-md-4">
                                        <div id="light-warning"></div>
                                        <h4 style="text-align: center;">警报</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-12">
                                <h3>工位状态</h3>
                                <div class="row" style="display: flex; justify-content:center;">
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-1"></div>
                                        <h4 style="text-align: center;">OP005A</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-2"></div>
                                        <h4 style="text-align: center;">OP101SA</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-3"></div>
                                        <h4 style="text-align: center;">OP020SA</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-4"></div>
                                        <h4 style="text-align: center;">OP030SA</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-5"></div>
                                        <h4 style="text-align: center;">OP040A</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-6"></div>
                                        <h4 style="text-align: center;">OP050A</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-7"></div>
                                        <h4 style="text-align: center;">OP060M</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-8"></div>
                                        <h4 style="text-align: center;">OP070A</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-9"></div>
                                        <h4 style="text-align: center;">OP075M</h4>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-1" id="status-1-10"></div>
                                        <h4 style="text-align: center;">OP08A</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-12">
                                <h3>通讯与上电状态</h3>
                                <h4>通信</h4>
                                <div class="row" style="display: flex; justify-content:center;">
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-0"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-1"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-2"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-3"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-4"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-5"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-6"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-7"></div>
                                    </div>
                                </div>
                                <div class="row" style="margin-top: 10px; display: flex; justify-content:center;">
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-8"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-9"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-10"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-11"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-12"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-13"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-14"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-2-15"></div>
                                    </div>
                                </div>
                                <hr>
                                <h4>上电</h4>
                                <div class="row" style="display: flex; justify-content:center;">
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-0"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-1"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-2"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-3"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-4"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-5"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-6"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-7"></div>
                                    </div>
                                </div>
                                <div class="row" style="margin-top: 10px; display: flex; justify-content:center;">
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-8"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-9"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-10"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-11"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-12"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-13"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-14"></div>
                                    </div>
                                    <div class="col-md-1">
                                        <div class="light-status-2" id="status-3-15"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane" id="tab6">

                        <div class="col-md-12">
                            <div class="panel panel-primary" style="text-align:center;margin-top: 50px;height: 300px;">
                                <div class="panel-heading">
                                    <h3 class="panel-title">统计结果展示</h3>
                                </div>

                                <div class="col-md-6">
                                    <p style="text-align: center; margin-top: 30px;">
                                        <button class="btn btn-primary" type="button"
                                            style="width: 200px;height: 50px;margin-right: -300px;">
                                            产品合格率 <span class="badge" id="passRate">0</span>
                                        </button>
                                    </p>
                                    <p style="text-align: center;">
                                        <button class="btn btn-primary" type="button"
                                            style="width: 200px;height: 50px;margin-right: -300px;">
                                            拧紧合格率 <span class="badge" id="tightRate">0</span>
                                        </button>
                                    </p>
                                    <p style="text-align: center;">
                                        <button class="btn btn-primary" type="button"
                                            style="width: 200px;height: 50px;margin-right: -300px;">
                                            压装合格率 <span class="badge" id="pressRate">0</span>
                                        </button>
                                    </p>
                                </div>

                                <div class="col-md-6">
                                    <p style="text-align: center;margin-top: 60px;">
                                        <button class="btn btn-primary" type="button"
                                            style="width: 200px;height: 50px;margin-left: -300px;">
                                            完成产品数 <span class="badge" id="sumofFinishedP">0</span> 个
                                        </button>
                                    </p>
                                    <p style="text-align: center;">
                                        <button class="btn btn-primary" type="button"
                                            style="width: 200px;height: 50px;margin-left: -300px;">
                                            合格产品数 <span class="badge" id="sumofPassedP">0</span> 个
                                        </button>
                                    </p>
                                </div>

                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="panel panel-primary" style="text-align:center;height: 300px;">
                                <div class="panel-heading">
                                    <h3 class="panel-title">产品-耗时统计结果图</h3>
                                </div>
                                <div id="timeChart" style="height: 300px;"></div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="panel panel-primary" style="text-align:center;height: 300px;">
                                <div class="panel-heading">
                                    <h3 class="panel-title">压力分布统计结果图</h3>
                                </div>
                                <div id="PressPieChart" style="height: 300px;"></div>
                            </div>
                        </div>


                        <div class="col-md-6">
                            <div class="panel panel-primary" style="text-align:center;height: 300px;">
                                <div class="panel-heading">
                                    <h3 class="panel-title">位移分布统计结果图</h3>
                                </div>
                                <div id="DisplacePieChart" style="height: 300px;"></div>
                            </div>
                        </div>


                        <div class="col-md-6">
                            <div class="panel panel-primary" style="text-align:center;height: 300px;">
                                <div class="panel-heading">
                                    <h3 class="panel-title">扭矩分布统计结果图</h3>
                                </div>
                                <div id="TorquePieChart" style="height: 300px;"></div>
                            </div>
                        </div>
                    </div>


                    <div class="tab-pane" id="tab7">
                        <div class="col-md-12">
                            <div class="panel panel-warning" style="margin-top: 20px;margin-bottom: 20px">
                                <div class="panel-heading">
                                    <h3 class="panel-title">产品监控</h3>
                                </div>
                                <div class="panel-body" style="overflow:auto;height: 300px;position:relative"
                                    id="productWatch"></div>
                            </div>
                        </div>

                        <div class="col-md-12 col-sm-12">
                            <div class="panel panel-primary" style="margin-top: 20px;margin-bottom: 20px">
                                <div class="panel-heading">
                                    <h3 class="panel-title">产品KPI</h3>
                                </div>
                                <div class="panel-body" style="overflow:auto;height: 300px;position:relative" id="KPI">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>

    <script>
        var tempid = -1,
            data040 = [],
            data070 = [],
            dis010 = [],
            dis020 = [],
            press010 = [],
            press020 = [],
            bottleneck = 0,
            stationData = Array(7).fill(0),
            pieData = [
                { value: 0, name: '0～10s' },
                { value: 0, name: '10～20s' },
                { value: 0, name: '20～30s' },
                { value: 0, name: '30～40s' },
                { value: 0, name: '40～50s' },
                { value: 0, name: '50～60s' },
                { value: 0, name: '60～70s' },
                { value: 0, name: '70～80s' },
                { value: 0, name: '80～90s' },
                { value: 0, name: '90s以上' }
            ],
            PressPieData = [
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' }
            ],
            DisplacePieData = [
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' }
            ],
            TorquePieData = [
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' },
                { value: 0, name: '' }
            ],

            id = [];
        var station_status = Array(11).fill(0);//工位状态监控
        var station_isread = Array(11).fill(2);
        var sp_status = Array(17).fill(0);//0代表产线未运行，1代表产线正常运行，2代表产线出现错误
        var sp_isread = Array(76).fill(2);//0未读，1已读，2为初始状态
        var sc_status = Array(17).fill(0);
        var sc_isread = Array(17).fill(2);
        var PLCstatus = { status: 0, isread: 2 };

        //压装工位阈值
        var HighPress = 5;
        var LowPress = -5;
        var AveragePress = 0;

        //拧紧工位阈值
        var HighTight = 5;
        var LowTight = -5;
        var AverageTight = 0;

        //潜在危险计数器
        var lowCount040 = 0;
        var highCount040 = 0;
        var lowCount070 = 0;
        var highCount070 = 0;
        var lowCount010 = 0;
        var highCount010 = 0;
        var lowCount020 = 0;
        var highCount020 = 0;

        //产线状态监控按钮onclick函数
        function statusBtn() {
            for (var i = 1; i <= 7; i++) {
                $("#tab" + String(i)).attr("class", "tab-pane");
                $("#tab_btn_" + String(i)).removeAttr("class");
            }
            $("#tab_btn_5").attr("class", "active");
            $("#tab5").attr("class", "tab-pane active");
            $("#statusWatch").attr("class", "btn btn-default");
            PLCstatus.isread = 1;
            for (var i = 1; i <= 10; i++) {
                station_isread[i] = 1;
            }
            for (var i = 0; i < 16; i++) {
                sc_isread[i] = 1;
                sp_isread[i] = 1;
            }
        }

        //警报页面按钮onclick函数
        function warningBtn() {
            for (var i = 1; i <= 7; i++) {
                $("#tab" + String(i)).attr("class", "tab-pane");
                $("#tab_btn_" + String(i)).removeAttr("class");
            }
            $("#tab_btn_4").attr("class", "active");
            $("#tab4").attr("class", "tab-pane active");
            $("#warningWatch").attr("class", "btn btn-default");
        }

        //状态监控函数
        function stateWatch() {
            var stateUrl = "http://localhost:8080/states"

            $.getJSON(stateUrl, function (json_data) {
                if (json_data['PLC_station_running'] == "1") {
                    PLCstatus.status = 1;

                }
                if (json_data["PLC_station_stop"] == "1") {
                    PLCstatus.status = 0;

                }
                if (json_data["PLC_station_error"] == "1") {
                    PLCstatus.status = 2;
                }

                for (var i = 1; i <= 10; i++) {
                    if (json_data["line1_station" + String(i) + "_error"] == "1") {
                        station_status[i] = 2;
                    }
                    else if (json_data["line1_station" + String(i) + "_error"] == "0") {
                        station_status[i] = 1;
                    }
                }

                for (var i = 1; i <= 16; i++) {
                    if (json_data["sc" + String(i)] == "0") {
                        sc_status[i - 1] = 2;
                    }
                    else if (json_data["sc" + String(i)] == "1") {
                        sc_status[i - 1] = 1;
                    }
                    if (json_data["se" + String(i)] == "0") {
                        sp_status[i - 1] = 2;
                    }
                    else if (json_data["se" + String(i)] == "1") {
                        sp_status[i - 1] = 1;
                    }
                }
            });


            //工位状态监控
            for (var i = 1; i <= 10; i++) {
                if (station_status[i] == 2) {
                    if (station_isread[i] == 2) {
                        station_isread[i] = 0;
                    }

                    $("#status-1-" + String(i)).attr("style", "background-color:lightcoral;");
                    if (station_isread[i] == 0) {
                        $("#statusWatch").attr('class', 'btn btn-danger');
                    }
                }

                else if (station_status[i] == 1) {
                    $("#status-1-" + String(i)).attr("style", "background-color:lightgreen;");
                    station_isread[i] = 2;
                }
                else {
                    $("#status-1-" + String(i)).removeAttr("style");
                    station_isread[i] = 2;
                }
            }

            //sc、sp状态监控
            for (var i = 1; i <= 16; i++) {
                if (sc_status[i - 1] == 2) {
                    if (sc_isread[i - 1] == 2) {
                        sc_isread[i - 1] = 0;
                    }

                    $("#status-2-" + String(i - 1)).attr("style", "background-color:lightcoral;");
                    if (sc_isread[i - 1] == 0) {
                        $("#statusWatch").attr('class', 'btn btn-danger');
                    }
                }
                else if (sc_status[i - 1] == 1) {
                    $("#status-2-" + String(i - 1)).attr("style", "background-color:lightgreen;");
                    sc_isread[i - 1] = 2;
                }
                else {
                    $("#status-2-" + String(i - 1)).removeAttr("style");
                    sc_isread[i - 1] = 2;
                }

                if (sp_status[i - 1] == 2) {
                    if (sp_isread[i - 1] == 2) {
                        sp_isread[i - 1] = 0;
                    }
                    $("#status-3-" + String(i - 1)).attr("style", "background-color:lightcoral;");
                    if (sp_isread[i - 1] == 0) {
                        $("#statusWatch").attr('class', 'btn btn-danger');
                    }
                }
                else if (sp_status[i - 1] == 1) {
                    $("#status-3-" + String(i - 1)).attr("style", "background-color:lightgreen;");
                    sp_isread[i] = 2;
                }
                else {
                    $("#status-3-" + String(i - 1)).removeAttr("style");
                    sp_isread[i - 1] = 2;
                }
            }

            //PLC状态
            if (PLCstatus.status == 1) {
                $("#light-running").attr("style", "background-color:lightgreen");
                PLCstatus.isread = 2;
            }
            else {
                $("#light-running").removeAttr("style");
            }
            if (PLCstatus.status == 0) {
                $("#light-stop").attr("style", "background-color:gray");
                PLCstatus.isread = 2;
            }
            else {
                $("#light-stop").removeAttr("style");
            }
            if (PLCstatus.status == 2) {
                if (PLCstatus.isread == 2) {
                    PLCstatus.isread = 0;
                }
                $("#light-warning").attr("style", "background-color:lightcoral");
                if (PLCstatus.isread == 0) {
                    $("#statusWatch").attr('class', 'btn btn-danger');
                }
            }
            else {
                $("#light-warning").removeAttr("style");
            }
        }

        //小数转换成百分数函数
        function toPercent(point) {
            if (point == 0) {
                return 0;
            }
            var str = Number(point * 100).toFixed(2);
            str += "%";
            return str;
        }

        //产品是否合格判断函数
        function productJudge() {
            var productString = "";
            var productUrl = "http://localhost:8080/PASS_OK_NG";
            var all_status;
            var productID;
            $.getJSON(productUrl, function (json_data) {
                all_status = json_data['allok'];
                productID = Number(json_data['id']);
            })

            var now = new Date();
            var nowtime = now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate() + " " + now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds() + "  ";
            if (!all_status) {
                var stationStatus = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                var stationBypass = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
                $.getJSON(productUrl, function (json_data) {
                    stationStatus[2] = json_data['line1_station2_product_OK'];
                    stationBypass[2] = json_data['line1_station2_bypass'];
                    stationStatus[3] = json_data['line1_station3_product_OK'];
                    stationBypass[3] = json_data['line1_station3_bypass'];
                    stationStatus[4] = json_data['line1_station4_product_OK'];
                    stationBypass[4] = json_data['line1_station4_bypass'];
                    stationStatus[5] = json_data['line1_station5_product_OK'];
                    stationBypass[5] = json_data['line1_station5_bypass'];
                    stationStatus[7] = json_data['line1_station7_product_OK'];
                    stationBypass[7] = json_data['line1_station7_bypass'];
                    stationStatus[8] = json_data['line1_station8_product_OK'];
                    stationBypass[8] = json_data['line1_station8_bypass'];
                    stationStatus[10] = json_data['line1_station10_product_OK'];
                    stationBypass[10] = json_data['line1_station10_bypass'];
                    productString = nowtime + "产品" + productID + "质量不合格，问题工位为：";
                    if (!stationBypass[2] && !stationStatus[2]) {
                        productString += "<span class=\"label label-danger\">OP010SA</span> ";
                    }
                    if (!stationBypass[3] && !stationStatus[3]) {
                        productString += "<span class=\"label label-danger\">OP020SA</span> ";
                    }
                    if (!stationBypass[4] && !stationStatus[4]) {
                        productString += "<span class=\"label label-danger\">OP030SA</span> ";
                    }
                    if (!stationBypass[5] && !stationStatus[5]) {
                        productString += "<span class=\"label label-danger\">OP040A</span> ";
                    }
                    if (!stationBypass[7] && !stationStatus[7]) {
                        productString += "<span class=\"label label-danger\">OP060M</span> ";
                    }
                    if (!stationBypass[8] && !stationStatus[8]) {
                        productString += "<span class=\"label label-danger\">OP070A</span> ";
                    }
                    if (!stationBypass[10] && !stationStatus[10]) {
                        productString += "<span class=\"label label-danger\">OP80A</span> ";
                    }
                    $('#productWatch').append("<p>" + productString + "</p>");
                })

            }
            else {
                productString = nowtime + "产品" + productID + "质量合格";
                $('#productWatch').append("<p>" + productString + "</p>");
            }
        }

        //KPI获取函数
        function getKPI() {
            var KPIUrl = "http://localhost:8080/kpi1";
            $.getJSON(KPIUrl, function (json_data) {
                KPIstring = "编号" + json_data[0]['pid'] + "    上线时间：" + json_data[0]['oy'] + "-" + json_data[0]['omon'] + "-" + json_data[0]['od'] + "  " + json_data[0]['oh'] + ":" + json_data[0]['omin'] + ":" + json_data[0]['osec'] + "    下线时间：" + json_data[0]['ofy'] + "-" + json_data[0]['ofmon'] + "-" + json_data[0]['ofday'] + "  " + json_data[0]['ofhour'] + ":" + json_data[0]['ofmin'] + ":" + json_data[0]['ofsec'] + "    制作时间：" + json_data[0]['time_consume'] + "秒";
                $('#KPI').append("<p>" + KPIstring + "</p>");
                $('#tightRate').text(toPercent(Number(json_data[2]['screw_percent'])));
                $('#pressRate').text(toPercent(Number(json_data[1]['press_percent'])));
            });
        }

        //瓶颈工位、耗时分布图、合格率、产品拧紧和压装数据获取函数
        function getData() {
            var url = "http://localhost:8080/sample1";
            var station = "http://localhost:8080/l1neck";
            var timeUrl = "http://localhost:8080/recent50";
            var numOfProductUrl = "http://localhost:8080/qualified"
            var dataUrl = "http://localhost:8080/diversion";
            var recent50Url = "http://localhost:8080/PDTA";
            var KPIstring = "";

            $.getJSON(dataUrl, function (json_data) {
                id.push(json_data[0]['id']);
                data040.push(json_data[0]['avg_torque_diversion040']);
                data070.push(json_data[0]['avg_torque_diversion070']);
                dis010.push(json_data[1]['avg_010_dis']);
                dis020.push(json_data[1]['avg_020_dis']);
                press010.push(json_data[1]['avg_010_press']);
                press020.push(json_data[1]['avg_020_press']);

                if (id.length > 10) {
                    id.shift();
                    data040.shift();
                    data070.shift();
                    dis010.shift();
                    dis020.shift();
                    press010.shift();
                    press020.shift();
                }

                Chart1.hideLoading();
                Chart2.hideLoading();
                Chart3.hideLoading();
                Chart4.hideLoading();
                Chart5.hideLoading();
                Chart6.hideLoading();
                timeChart.hideLoading();
                PressPiechart.hideLoading();
                TorquePiechart.hideLoading();
                DisplacePiechart.hideLoading();
                Colchart.hideLoading();
            });

            $.getJSON(timeUrl, function (json_data) {
                for (var i = 0; i < 10; i++) {
                    pieData[i].value = Number(json_data[i]);
                }
            });

            $.getJSON(recent50Url, function (json_data) {
                var temp = 0;
                for (var i = 1; i < 101; i += 16) {
                    PressPieData[temp].name = Number(json_data[i + 1]).toFixed(3) + "s~" + Number(json_data[i]).toFixed(3) + "s";
                    PressPieData[temp].value = json_data[i + 2];
                    temp += 1;
                }
                temp = 0;
                for (var i = 5; i < 105; i += 16) {
                    DisplacePieData[temp].name = Number(json_data[i + 1]).toFixed(3) + "s~" + Number(json_data[i]).toFixed(3) + "s";
                    DisplacePieData[temp].value = json_data[i + 2];
                    temp += 1;
                }
                temp = 0;
                for (var i = 9; i < 109; i += 16) {
                    TorquePieData[temp].name = Number(json_data[i + 1]).toFixed(3) + "~" + Number(json_data[i]).toFixed(3) + "s";
                    TorquePieData[temp].value = json_data[i + 2];
                    temp += 1;
                }
            });

            $.getJSON(station, function (json_data) {
                //获取瓶颈工位耗时
                let temp = "";
                Colchart.hideLoading();
                stationData[0] = Number(json_data['line1_station2_product_time']);
                stationData[1] = Number(json_data['line1_station3_product_time']);
                stationData[2] = Number(json_data['line1_station4_product_time']);
                stationData[3] = Number(json_data['line1_station5_product_time']);
                stationData[4] = Number(json_data['line1_station7_product_time']);
                stationData[5] = Number(json_data['line1_station8_product_time']);
                stationData[6] = Number(json_data['line1_station10_product_time']);
                switch (Number(json_data['Neck'])) {
                    case 2:
                        temp = "OP010SA"
                        break;
                    case 3:
                        temp = "OP020SA"
                        break;
                    case 4:
                        temp = "OP030SA"
                        break;
                    case 5:
                        temp = "OP040A"
                        break;
                    case 7:
                        temp = "OP060M"
                        break;
                    case 8:
                        temp = "OP070A"
                        break;
                    case 10:
                        temp = "OP80A"
                        break;

                }
                $("#bottlenID").text((temp + "号 当前产品id为" + Number(json_data['ID'])));
            });

            $.getJSON(numOfProductUrl, function (json_data) {
                $('#sumofFinishedP').text(json_data['finished']);
                $('#sumofPassedP').text(json_data['qualified']);
                $('#passRate').text(toPercent(Number(json_data['qualified_persentage'])));
            });

            Chart1.setOption(Chart1option);
            Chart2.setOption(Chart2option);
            Chart3.setOption(Chart3option);
            Chart4.setOption(Chart4option);
            Chart5.setOption(Chart5option);
            Chart6.setOption(Chart6option);
            Colchart.setOption(ColChartoption);
            timeChart.setOption(timeChartoption);
            PressPiechart.setOption(PressPieOption);
            TorquePiechart.setOption(TorquePieOption);
            DisplacePiechart.setOption(DisplacePieOption);
        }

        function productBasedData() {
            getData();
            getKPI();
            productJudge();
            judge();
        }

        function judge() {

            //监测040工位
            if (data040[data040.length - 1] > HighTight) {
                highCount040++;
                var now = new Date();
                let warningText = now + "产线出现严重危险：<span class=\"label label-danger\">040工位扭矩偏移量:</span>  <span class=\"label label-warning\">" + data040[data040.length - 1] + "</span>  大于最大阈值：" + HighTight;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (data040[data040.length - 1] < LowTight) {
                lowCount040++;
                var now = new Date();
                let warningText = now + "产线出现严重危险：<span class=\"label label-danger\">040工位扭矩偏移量:</span>  <span class=\"label label-warning\">" + data040[data040.length - 1] + "</span>  低于最小阈值：" + LowTight;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (data040[data040.length - 1] > AverageTight && data040[data040.length - 1] < HighTight) {
                highCount040++;
                lowCount040 = 0;
            } else if (data040[data040.length - 1] < AverageTight && data040[data040.length - 1] > LowTight) {
                highCount040 = 0;
                lowCount040++;
            }

            if (highCount040 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">040工位扭矩偏移量</span>连续  <span class=\"label label-warning\">" + highCount040 + "</span>  次高于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (lowCount040 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">040工位扭矩偏移量</span>连续  <span class=\"label label-warning\">" + lowCount040 + "</span>  次低于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            }

            //监控070工位
            if (data070[data070.length - 1] > HighTight) {
                highCount070++;
                var now = new Date();
                let warningText = now + "产线出现严重危险：<span class=\"label label-danger\">070工位扭矩偏移量:</span>  <span class=\"label label-warning\">" + data070[data070.length - 1] + "</span>  大于最大阈值：" + HighTight;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (data070[data070.length - 1] < LowTight) {
                lowCount070++;
                var now = new Date();
                let warningText = now + "产线出现严重危险：<span class=\"label label-danger\">070工位扭矩偏移量:</span>  <span class=\"label label-warning\">" + data070[data070.length - 1] + "</span>  低于最小阈值：" + LowTight;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (data070[data070.length - 1] > AverageTight && data070[data070.length - 1] < HighTight) {
                highCount070++;
                lowCount070 = 0;
            } else if (data070[data070.length - 1] < AverageTight && data070[data070.length - 1] > LowTight) {
                highCount070 = 0;
                lowCount070++;
            }

            if (highCount070 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">070工位扭矩偏移量</span>连续  <span class=\"label label-warning\">" + highCount070 + "</span>  次高于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (lowCount070 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">070工位扭矩偏移量</span>连续  <span class=\"label label-warning\">" + lowCount070 + "</span>  次低于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            }

            //010
            if (press010[press010.length - 1] > HighPress) {
                highCount010++;
                var now = new Date();
                let warningText = now + "<span class=\"label label-danger\">产线出现严重危险：010工位压力偏移量:</span>  <span class=\"label label-warning\">" + press010[press010.length - 1] + "</span>  大于最大阈值：" + HighPress;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (press010[press010.length - 1] < LowPress) {
                lowCount010++;
                var now = new Date();
                let warningText = now + "产线出现严重危险：<span class=\"label label-danger\">010工位压力偏移量:</span>  <span class=\"label label-warning\">" + press010[press010.length - 1] + "</span>  低于最小阈值：" + LowPress;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (press010[press010.length - 1] > AveragePress && press010[press010.press010 - 1] < HighPress) {
                highCount010++;
                lowCount010 = 0;
            } else if (press010[press010.length - 1] < AveragePress && press010[press010.length - 1] > LowPress) {
                highCount010 = 0;
                lowCount010++;
            }

            if (highCount010 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">010工位压力偏移量</span>连续  <span class=\"label label-warning\">" + highCount010 + "</span>  次高于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (lowCount010 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">010工位压力偏移量</span>连续  <span class=\"label label-warning\">" + lowCount010 + "</span>  次低于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            }

            //020
            if (press020[press020.length - 1] > HighPress) {
                highCount020++;
                var now = new Date();
                let warningText = now + "<span class=\"label label-danger\">产线出现严重危险：020工位压力偏移量:</span>  <span class=\"label label-warning\">" + press020[press020.length - 1] + "</span>  大于最大阈值：" + HighPress;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (press020[press020.length - 1] < LowPress) {
                lowCount020++;
                var now = new Date();
                let warningText = now + "产线出现严重危险：<span class=\"label label-danger\">020工位压力偏移量:</span>  <span class=\"label label-warning\">" + press020[press020.length - 1] + "</span>  低于最小阈值：" + LowPress;
                $('#warningLog1').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (press020[press020.length - 1] > AveragePress && press020[press020.press020 - 1] < HighPress) {
                highCount020++;
                lowCount020 = 0;
            } else if (press020[press020.length - 1] < AveragePress && press020[press020.length - 1] > LowPress) {
                highCount020 = 0;
                lowCount020++;
            }

            if (highCount020 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">020工位压力偏移量</span>连续  <span class=\"label label-warning\">" + highCount020 + "</span>  次高于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            } else if (lowCount020 >= 5) {
                var now = new Date();
                let warningText = now + "产线出现潜在危险：<span class=\"label label-danger\">020工位压力偏移量</span>连续  <span class=\"label label-warning\">" + lowCount020 + "</span>  次低于中位阈值：" + AveragePress;
                $('#warningLog2').append("<p>" + warningText + "</p>");
                $("#warningWatch").attr('class', 'btn btn-danger');
            }
        }


        //图表标线设置函数
        function freshLine() {
            var TightwarningLineOp = {
                series: [{
                    markLine: {
                        symbol: "none",               //去掉警戒线最后面的箭头
                        label: {
                            position: "middle"         //将警示值放在哪个位置，三个值“start”,"middle","end"  开始  中点 结束
                        },
                        data: [{
                            type: 'max',
                            label: {
                                show: true,
                                formatter: "高位阈值: " + HighTight,
                            },
                            name: "高位阈值",             //鼠标悬停事件  true没有，false有
                            lineStyle: {
                                type: "solid",
                                color: "#FA3934",
                            },
                            yAxis: HighTight          // 警戒线的标注值，可以有多个yAxis,多条警示线   或者采用   {type : 'average', name: '平均值'}，type值有  max  min  average，分为最大，最小，平均值
                        },
                        {
                            type: 'min',
                            name: "低位阈值",
                            label: {
                                show: true,
                                formatter: "低位阈值: " + LowTight,
                            },
                            lineStyle: {
                                type: "solid",
                                color: "#FA3934",
                            },
                            yAxis: LowTight
                        }
                        ]
                    }
                }]
            };

            var PresswarningLineOp = {
                series: [{
                    markLine: {
                        symbol: "none",               //去掉警戒线最后面的箭头
                        label: {
                            position: "middle"         //将警示值放在哪个位置，三个值“start”,"middle","end"  开始  中点 结束
                        },
                        data: [{
                            type: 'max',
                            label: {
                                show: true,
                                formatter: "高位阈值: " + HighPress,
                            },
                            name: "高位阈值",             //鼠标悬停事件  true没有，false有
                            lineStyle: {
                                type: "solid",
                                color: "#FA3934",
                            },
                            yAxis: HighPress          // 警戒线的标注值，可以有多个yAxis,多条警示线   或者采用   {type : 'average', name: '平均值'}，type值有  max  min  average，分为最大，最小，平均值
                        },
                        {
                            type: 'min',
                            name: "低位阈值",
                            label: {
                                show: true,
                                formatter: "低位阈值: " + LowPress,
                            },
                            lineStyle: {
                                type: "solid",
                                color: "#FA3934",
                            },
                            yAxis: LowPress
                        }
                        ]
                    }
                }]
            };

            Chart1.setOption(TightwarningLineOp);
            Chart2.setOption(TightwarningLineOp);
            Chart3.setOption(PresswarningLineOp);
            Chart5.setOption(PresswarningLineOp);
        }
        //压装参数修改提交按钮onclick函数
        function ChangePress() {
            pressFlag = 1;
            LowPress = Number(document.getElementById('Plow').value);
            HighPress = Number(document.getElementById('Phigh').value);
            $('#ph').text("高位阈值(当前值: " + HighPress + ")");
            $('#pl').text("低位阈值(当前值: " + LowPress + ")");
        }

        //拧紧参数修改提交按钮onclick函数
        function ChangeTight() {
            tightFlag = 1;
            LowTight = Number(document.getElementById('Tlow').value);
            HighTight = Number(document.getElementById('Thigh').value);
            $('#th').text("高位阈值(当前值: " + HighTight + ")");
            $('#tl').text("低位阈值(当前值: " + LowTight + ")");
            freshLine();
        }

        function Reset() {
            document.getElementById('Plow').value = "";
            document.getElementById('Phigh').value = "";
            document.getElementById('Thigh').value = "";
            document.getElementById('Tlow').value = "";
        }

        var timeChartoption = {
            title: {
                text: '产品-耗时统计结果图',
                left: 'center'
            },
            tooltip: {
                trigger: 'item'
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            label: {
                alignTo: 'edge',
                formatter: '{name|{b}} ｜ {value|{c}个}',
                minMargin: 5,
                edgeDistance: 10,
                lineHeight: 15,
                rich: {
                    value: {
                        fontSize: 15,
                        color: '#999'
                    }
                }
            },
            labelLine: {
                length: 15,
                length2: 0,
                maxSurfaceAngle: 80
            },
            legend: {
                orient: 'vertical',
                left: 'left',
            },
            series: [
                {
                    name: '耗时',
                    type: 'pie',
                    radius: '50%',
                    data: pieData,
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        var PressPieOption = {
            title: {
                text: '压力统计结果图',
                left: 'center'
            },
            tooltip: {
                trigger: 'item'
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            label: {
                alignTo: 'edge',
                formatter: '{name|{b}}\n{value|{c}个}',
                minMargin: 5,
                edgeDistance: 10,
                lineHeight: 15,
                rich: {
                    value: {
                        fontSize: 15,
                        color: '#999'
                    }
                }
            },
            labelLine: {
                length: 15,
                length2: 0,
                maxSurfaceAngle: 80
            },
            legend: {
                orient: 'vertical',
                left: 'left',
            },
            series: [
                {
                    name: '耗时',
                    type: 'pie',
                    radius: '50%',
                    data: PressPieData,
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        var DisplacePieOption = {
            title: {
                text: '位移统计结果图',
                left: 'center'
            },
            tooltip: {
                trigger: 'item'
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            label: {
                alignTo: 'edge',
                formatter: '{name|{b}}\n{value|{c}个}',
                minMargin: 5,
                edgeDistance: 10,
                lineHeight: 15,
                rich: {
                    value: {
                        fontSize: 15,
                        color: '#999'
                    }
                }
            },
            labelLine: {
                length: 15,
                length2: 0,
                maxSurfaceAngle: 80
            },
            legend: {
                orient: 'vertical',
                left: 'left',
            },
            series: [
                {
                    name: '耗时',
                    type: 'pie',
                    radius: '50%',
                    data: DisplacePieData,
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        var TorquePieOption = {
            title: {
                text: '扭矩统计结果图',
                left: 'center'
            },
            tooltip: {
                trigger: 'item'
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            label: {
                alignTo: 'edge',
                formatter: '{name|{b}}\n{value|{c}个}',
                minMargin: 5,
                edgeDistance: 10,
                lineHeight: 15,
                rich: {
                    value: {
                        fontSize: 15,
                        color: '#999'
                    }
                }
            },
            labelLine: {
                length: 15,
                length2: 0,
                maxSurfaceAngle: 80
            },
            legend: {
                orient: 'vertical',
                left: 'left',
            },
            series: [
                {
                    name: '耗时',
                    type: 'pie',
                    radius: '50%',
                    data: TorquePieData,
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        var ColChartoption = {
            title: {
                text: '瓶颈工位监测'
            },
            xAxis: {
                name: '工位',
                type: 'category',
                data: ['伺服压机\nOP010SA', '液压站\nOP020SA', '人工预处理工位\nOP030SA', '自动拧紧工位\nOP040A', '人工预处理工位\nOP060M', '自动拧紧工位\nOP070A', '下料位\nOP80A']
            },
            yAxis: {
                name: '耗时/秒',
                type: 'value'
            },
            toolbox: {
                feature: {
                    saveAsImage: {}
                }
            },
            series: [{
                data: stationData,
                type: 'bar',
                showBackground: true,
                backgroundStyle: {
                    color: 'rgba(180, 180, 180, 0.2)'
                }
            }]
        };

        var Chart1option = {
            title: {
                text: '040工位扭矩偏移量'
            },
            tooltip: {
                trigger: 'axis'
            },
            toolbox: {
                show: true,
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    dataView: { readOnly: false },
                    saveAsImage: {}
                }
            },
            legend: {
                data: ['偏移量']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                name: 'id',
                type: 'category',
                boundaryGap: false,
                data: id
            },
            yAxis: {
                name: '偏移量',
                type: 'value',
                boundaryGap: [0, '50%'],
            },
            series: [{
                name: '偏移量',
                type: 'line',
                data: data040,
                stack: '值'
            }]
        }

        var Chart2option = {
            title: {
                text: '070工位扭矩偏移量'
            },
            toolbox: {
                show: true,
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    dataView: { readOnly: false },
                    saveAsImage: {}
                }
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['偏移量']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                name: 'id',
                type: 'category',
                boundaryGap: false,
                data: id
            },
            yAxis: {
                name: '偏移量',
                type: 'value',
                boundaryGap: [0, '50%'],
            },
            series: [{
                name: '偏移量',
                type: 'line',
                data: data070,
                stack: '值'
            }]
        }

        var Chart3option = {
            title: {
                text: 'OP010SA压力偏移量'
            },
            toolbox: {
                show: true,
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    dataView: { readOnly: false },
                    saveAsImage: {}
                }
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['偏移量']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                name: 'id',
                type: 'category',
                boundaryGap: false,
                data: id
            },
            yAxis: {
                name: '偏移量',
                type: 'value',
                boundaryGap: [0, '50%'],
            },
            series: [{
                name: '偏移量',
                type: 'line',
                data: press010,
                stack: '值'
            }]
        }

        var Chart4option = {
            title: {
                text: 'OP010SA位移值'
            },
            toolbox: {
                show: true,
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    dataView: { readOnly: false },
                    saveAsImage: {}
                }
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['位移值']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                name: 'id',
                type: 'category',
                boundaryGap: false,
                data: id
            },
            yAxis: {
                name: '位移值',
                type: 'value',
                boundaryGap: [0, '50%'],

            },
            series: [{
                name: '位移值',
                type: 'line',
                data: dis010,
                stack: '值'
            }]
        }

        var Chart5option = {
            title: {
                text: 'OP020SA压力偏移量'
            },
            toolbox: {
                show: true,
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    dataView: { readOnly: false },
                    saveAsImage: {}
                }
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['偏移量']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                name: 'id',
                type: 'category',
                boundaryGap: false,
                data: id
            },
            yAxis: {
                name: '偏移量',
                type: 'value',
                boundaryGap: [0, '50%'],

            },
            series: [{
                name: '偏移量',
                type: 'line',
                data: press020,
                stack: '值'
            }]
        }

        var Chart6option = {
            title: {
                text: 'OP020SA位移值'
            },
            tooltip: {
                trigger: 'axis'
            },
            toolbox: {
                show: true,
                feature: {
                    dataZoom: {
                        yAxisIndex: 'none'
                    },
                    dataView: { readOnly: false },
                    saveAsImage: {}
                }
            },
            legend: {
                data: ['位移值']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                name: 'id',
                type: 'category',
                boundaryGap: false,
                data: id
            },
            yAxis: {
                name: '位移值',
                type: 'value',
                boundaryGap: [0, '50%'],

            },
            series: [{
                name: '位移值',
                type: 'line',
                data: dis020,
                stack: '值'
            }]
        }

        // setInterval(function () {
        //     Resize();
        // }, 100);

        setInterval(function () {
            stateWatch();
            $.getJSON("http://localhost:8080/sample1", function (json_data) {
                tempid = Number(json_data[0]['id']);
            });
            if (tempid == id[id.length - 1])
                return;
            productBasedData();
        }, 1000);

        var Chart1 = echarts.init(document.getElementById('chart1'), 'shine');
        Chart1.setOption(Chart1option);

        var Chart2 = echarts.init(document.getElementById('chart2'), 'shine');
        Chart2.setOption(Chart2option);

        var Chart3 = echarts.init(document.getElementById('chart3'), 'shine');
        Chart3.setOption(Chart3option);

        var Chart4 = echarts.init(document.getElementById('chart4'), 'shine');
        Chart4.setOption(Chart4option);

        var Chart5 = echarts.init(document.getElementById('chart5'), 'shine');
        Chart5.setOption(Chart5option);

        var Chart6 = echarts.init(document.getElementById('chart6'), 'shine');
        Chart6.setOption(Chart6option);

        var Colchart = echarts.init(document.getElementById('ColChart'), 'shine');
        Colchart.setOption(ColChartoption);

        var timeChart = echarts.init(document.getElementById('timeChart'), 'shine');
        timeChart.setOption(timeChartoption);

        var PressPiechart = echarts.init(document.getElementById('PressPieChart'), 'shine');
        PressPiechart.setOption(PressPieChart);

        var TorquePiechart = echarts.init(document.getElementById('TorquePieChart'), 'shine');
        TorquePiechart.setOption(TorquePieChart);

        var DisplacePiechart = echarts.init(document.getElementById('DisplacePieChart'), 'shine');
        DisplacePiechart.setOption(DisplacePieChart);

    </script>
</body>

</html>